{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 713cb55ad9d0552675b0","webpack:///./src/index.js","webpack:///./src/web-deps.js"],"names":["formatDateTime","buildCanonicalRequest","buildStringToSign","preCalculateSigningKey","preCalculatedSign","sign","buildAuthorization","hash","algorithm","emptyHash","date","toISOString","replace","httpRequestMethod","canonicalURI","canonicalQueryString","canonicalHeaders","signedHeaders","requestPayload","Promise","resolve","then","hashedRequestPayload","join","requestDate","credentialScope","hashedCanonicalRequest","secretAccessKey","region","service","steps","promises","data","signingKey","stringToSign","accessKeyId","signature","map","item","hmac","crypto","window","msCrypto","subtle","webkitSubtle","normalize","encodeURI","toHex","buffer","bytes","Uint8Array","str","i","length","byte","toString","toBinary","TextEncoder","encode","len","buf","ArrayBuffer","bufView","Uint16Array","charCodeAt","hashOptions","name","algorithmSign","key","encoding","importKey","importedKey","digest"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"sigv4\"] = factory();\n\telse\n\t\troot[\"sigv4\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmory imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmory exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tObject.defineProperty(exports, name, {\n \t\t\tconfigurable: false,\n \t\t\tenumerable: true,\n \t\t\tget: getter\n \t\t});\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 713cb55ad9d0552675b0","import {hash, hmac, normalize} from 'deps';\n\nexport {hash};\n\nconst algorithm = 'AWS4-HMAC-SHA256';\nconst emptyHash = 'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855';\n\n/**\n * Formats a Date object to an AWS date string\n *\n * @param {!Date} date - The date\n * @returns {string} - The formatted date string\n */\nexport function formatDateTime(date) {\n\treturn date\n\t\t.toISOString()\n\t\t.replace(/-|:|(\\.\\d+)/g, '');\n}\n\n/**\n * Creates the canonical request\n * https://docs.aws.amazon.com/general/latest/gr/sigv4-create-canonical-request.html\n *\n * @param {!string} httpRequestMethod - The HTTP request method (e.g. `GET` or `POST`)\n * @param {!string} canonicalURI - The canonical URI\n * @param {!string} canonicalQueryString - The canonical query string\n * @param {!string} canonicalHeaders - The canonical headers\n * @param {!string} signedHeaders - The signed headers\n * @param {!string} requestPayload - The payload of the request\n * @returns {Promise<string>} - The canonical request\n */\nexport function buildCanonicalRequest(httpRequestMethod, canonicalURI, canonicalQueryString, canonicalHeaders, signedHeaders,\n                                 requestPayload='') {\n\treturn (requestPayload ? hash(requestPayload) : Promise.resolve(emptyHash))\n\t\t.then(hashedRequestPayload => [\n\t\t\thttpRequestMethod,\n\t\t\tcanonicalURI,\n\t\t\tcanonicalQueryString,\n\t\t\tcanonicalHeaders,\n\t\t\t'',\n\t\t\tsignedHeaders,\n\t\t\thashedRequestPayload\n\t\t].join('\\n'));\n}\n\n/**\n * Creates the string to sign\n * https://docs.aws.amazon.com/general/latest/gr/sigv4-create-string-to-sign.html\n *\n * @param {!string} requestDate - The request date (`YYYMMDDThhmmssZ`)\n * @param {!string} credentialScope - the credential scope (formatted as `YYYYMMDD/region/service/aws4_request`)\n * @param {!string} hashedCanonicalRequest\n * @returns {string} - The string to sign\n */\nexport function buildStringToSign(requestDate, credentialScope, hashedCanonicalRequest) {\n\treturn [\n\t\talgorithm,\n\t\trequestDate,\n\t\tcredentialScope,\n\t\thashedCanonicalRequest\n\t].join('\\n');\n}\n\n/**\n * Pre-calculates the signing key\n * https://docs.aws.amazon.com/general/latest/gr/sigv4-calculate-signature.html\n *\n * @param {!string} secretAccessKey - The secret access key for the AWS account\n * @param {!string} date - The date in YYYYMMDD format\n * @param {!string} region - The AWS region (e.g. `us-east-1`)\n * @param {!string} service - The AWS service (e.g. `iam`)\n * @returns {Promise<string>} - The pre-calculated signing key\n */\nexport function preCalculateSigningKey(secretAccessKey, date, region, service) {\n\tconst steps = [\n\t\tdate,\n\t\tregion,\n\t\tservice,\n\t\t'aws4_request'\n\t];\n\n\tlet promises = Promise.resolve(`AWS4${secretAccessKey}`);\n\n\tfor (const data of steps)\n\t\tpromises = promises.then(signingKey => hmac(signingKey, data));\n\n\treturn promises;\n}\n\n/**\n * Pre-calculates the signature\n * https://docs.aws.amazon.com/general/latest/gr/sigv4-calculate-signature.html\n *\n * @param {!string} signingKey - The pre-calculated signing key\n * @param {!string} stringToSign - The string to sign\n * @returns {Promise<string>} - The pre-calculated signature\n */\nexport function preCalculatedSign(signingKey, stringToSign) {\n\treturn hmac(signingKey, stringToSign, 'hex');\n}\n\n/**\n * Calculates the signature\n * https://docs.aws.amazon.com/general/latest/gr/sigv4-calculate-signature.html\n *\n * @param {!string} secretAccessKey - The secret access key for the AWS account\n * @param {!string} date - The date in YYYYMMDD format\n * @param {!string} region - The AWS region (e.g. `us-east-1`)\n * @param {!string} service - The AWS service (e.g. `iam`)\n * @param {!string} stringToSign - The string to sign\n * @returns {Promise<string>} - The signature\n */\nexport function sign(secretAccessKey, date, region, service, stringToSign) {\n\treturn preCalculateSigningKey(secretAccessKey, date, region, service)\n\t\t.then(signingKey => preCalculatedSign(signingKey, stringToSign));\n}\n\n/**\n * Creates the authorization string\n * https://docs.aws.amazon.com/general/latest/gr/sigv4-add-signature-to-request.html\n *\n * @param {!string} accessKeyId\n * @param {!string} credentialScope\n * @param {!string} signedHeaders\n * @param {!string} signature\n * @returns {string}\n */\nexport function buildAuthorization(accessKeyId, credentialScope, signedHeaders, signature) {\n\treturn algorithm + ' ' + [\n\t\t['Credential', `${accessKeyId}/${credentialScope}`],\n\t\t['SignedHeaders', signedHeaders],\n\t\t['Signature', signature]\n\t]\n\t\t.map(item => item.join('='))\n\t\t.join(', ');\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","const crypto = window.crypto || window.msCrypto;\nconst subtle = crypto.subtle || crypto.webkitSubtle;\nconst algorithm = 'sha-256';\n\nexport const normalize = encodeURI;\n\nfunction toHex(buffer) {\n\tconst bytes = new Uint8Array(buffer);\n\n\tlet str = '';\n\n\tfor (let i = 0; i < bytes.length; ++i) {\n\t\tconst byte = bytes[i].toString(16);\n\t\tstr += `${byte.length < 2 ? '0' : ''}${byte}`;\n\t}\n\n\treturn str;\n}\n\nconst toBinary = ('TextEncoder' in window) ?\n\t(str => (new TextEncoder()).encode(str)) :\n\t(str => {\n\t\tconst len = str.length;\n\t\tconst buf = new ArrayBuffer(len * 2);\n\t\tconst bufView = new Uint16Array(buf);\n\t\tfor (let i = 0; i < len; i++)\n\t\t\tbufView[i] = str.charCodeAt(i);\n\t\treturn buf;\n\t});\n\nconst hashOptions = {\n\tname: algorithm\n};\n\nconst algorithmSign = {\n\tname: 'HMAC',\n\thash: hashOptions\n};\n\n/**\n * Computes the HMAC\n *\n * @param {!string|ArrayBuffer} key - The key\n * @param {!string} data - The data to hash\n * @param {?string} [encoding=binary] - The encoding type (hex|binary)\n * @returns {string|ArrayBuffer} - The output HMAC\n */\nexport function hmac(key, data, encoding='binary') {\n\treturn subtle\n\t\t.importKey(\n\t\t\t'raw',\n\t\t\ttypeof key === 'string' ? toBinary(key) : key,\n\t\t\talgorithmSign,\n\t\t\tfalse,\n\t\t\t['sign']\n\t\t)\n\t\t.then(importedKey => subtle\n\t\t\t.sign(\n\t\t\t\talgorithmSign,\n\t\t\t\timportedKey,\n\t\t\t\ttoBinary(data)\n\t\t\t)\n\t\t)\n\t\t.then(buffer =>\n\t\t\tencoding === 'binary' ? buffer : toHex(buffer)\n\t\t);\n}\n\n/**\n * Computes the hash\n *\n * @param {!string} data - The data to hash\n * @returns {string} - The hashed output\n */\nexport function hash(data) {\n\treturn subtle\n\t\t.digest(\n\t\t\thashOptions,\n\t\t\ttoBinary(data)\n\t\t)\n\t\t.then(toHex);\n}\n\n\n// WEBPACK FOOTER //\n// ./src/web-deps.js"],"sourceRoot":""}